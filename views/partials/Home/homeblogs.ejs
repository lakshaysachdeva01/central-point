<section class="blog1 section-padding bg-lightbrown">
    <div class="container">
        <div class="row mb-15">
            <div class="col-md-12 text-center">
                <div class="section-subtitle">Latest News</div>
                <div class="section-title">Hotel Articles</div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <% if (blogs && blogs.length > 0) { %>
                    <% const latestBlogs = blogs.slice().reverse() %>
                    <div class="owl-carousel owl-theme home-blog-carousel" data-blog-count="<%= latestBlogs.length %>">
                        <% latestBlogs.forEach((item, index) => { %>
                            <div class="item mt-10" onclick="window.location.href='/blog/<%= item.seoDetails.slug %>'">
                                <div class="img">
                                    <img src="<%= process.env.S3_BASE_URL + item.banner.image %>" class="img-fluid" alt="<%= item.title %>">
                                    <div class="cat"><%= item.category || 'Blog' %></div>
                                </div>
                                <div class="cont">
                                    <h4><a href="/blog/<%= item.seoDetails.slug %>" style="display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; line-clamp: 2; overflow: hidden; text-overflow: ellipsis;"><%= item.title %></a></h4>
                                    <div style="display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 3; line-clamp: 3; overflow: hidden; text-overflow: ellipsis; margin-bottom: 15px;"><%- item.description %></div>
                                    <div class="author">
                                        <div>
                                            <h5 style="font-family: Urbanist, sans-serif; font-size: 17px; font-weight: 400; margin-bottom: 0; color: #141414;"><%= item.postDate %></h5>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                <% } else { %>
                    <div class="col-12 text-center">
                        <p>No blog posts available.</p>
                    </div>
                <% } %>
            </div>
        </div>
    </div>
</section>

<script>
// Wait for custom.js to initialize, then override
setTimeout(function() {
    const homeBlogCarousel = $('.home-blog-carousel');
    if (homeBlogCarousel.length) {
        const blogCount = parseInt(homeBlogCarousel.attr('data-blog-count')) || 0;
        
        // Destroy any existing initialization from custom.js
        if (homeBlogCarousel.hasClass('owl-loaded')) {
            homeBlogCarousel.trigger('destroy.owl.carousel');
            homeBlogCarousel.removeClass('owl-loaded owl-carousel owl-theme');
            homeBlogCarousel.find('.owl-stage-outer').children().unwrap();
        }
        
        // Reinitialize with loop disabled if 3 or fewer items
        homeBlogCarousel.addClass('owl-carousel owl-theme').owlCarousel({
            loop: blogCount > 3,
            margin: 20,
            mouseDrag: true,
            autoplay: false,
            autoplayTimeout: 5000,
            dots: false,
            autoplayHoverPause: true,
            nav: true,
            navText: ["<span class='fa-light fa-angle-left'></span>", "<span class='fa-light fa-angle-right'></span>"],
            responsiveClass: true,
            responsive: {
                0: {
                    items: 1,
                    nav: false,
                    dots: true,
                    loop: false
                },
                600: {
                    items: 2,
                    nav: false,
                    dots: true,
                    loop: false
                },
                1000: {
                    items: 3,
                    loop: blogCount > 3
                }
            }
        });
    }
}, 100);
</script>
